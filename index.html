<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Financeiro - Ag√™ncia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container-main {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        .btn-primary:hover {
            opacity: 0.9;
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #667eea;
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container-main max-w-7xl mx-auto p-6 min-h-screen">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">üìä Dashboard Financeiro</h1>
            <p class="text-white opacity-90">Proje√ß√µes estrat√©gicas para sua ag√™ncia</p>
        </div>

        <!-- Controles -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Meta de Crescimento -->
            <div class="card p-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    üéØ Meta de Crescimento Anual (%)
                </label>
                <input type="range" id="growthSlider" min="0" max="100" value="20" class="w-full mb-2">
                <div id="growthValue" class="text-center text-2xl font-bold text-blue-600">20%</div>
            </div>

            <!-- Cen√°rio -->
            <div class="card p-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    üìà Cen√°rio de Proje√ß√£o
                </label>
                <select id="scenarioSelect" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    <option value="0.8">Conservador (80%)</option>
                    <option value="1.0" selected>Realista (100%)</option>
                    <option value="1.3">Otimista (130%)</option>
                </select>
            </div>

            <!-- Per√≠odo -->
            <div class="card p-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    üìÖ Per√≠odo de Proje√ß√£o (meses)
                </label>
                <input type="range" id="monthsSlider" min="6" max="24" value="12" class="w-full mb-2">
                <div id="monthsValue" class="text-center text-xl font-bold text-green-600">12 meses</div>
            </div>
        </div>

        <!-- KPIs Principais -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="card p-6 border-l-4 border-blue-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Receita M√©dia Hist√≥rica</p>
                        <p class="text-2xl font-bold text-gray-900">R$ 9.200</p>
                    </div>
                    <div class="text-blue-500 text-3xl">üí∞</div>
                </div>
            </div>

            <div class="card p-6 border-l-4 border-green-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Lucro M√©dio Mensal</p>
                        <p class="text-2xl font-bold text-gray-900">R$ 2.300</p>
                    </div>
                    <div class="text-green-500 text-3xl">üìà</div>
                </div>
            </div>

            <div class="card p-6 border-l-4 border-purple-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Meta Pr√≥ximo M√™s</p>
                        <p id="nextMonthTarget" class="text-2xl font-bold text-gray-900">R$ 9.500</p>
                    </div>
                    <div class="text-purple-500 text-3xl">üéØ</div>
                </div>
            </div>

            <div class="card p-6 border-l-4 border-orange-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Melhor M√™s (Set/24)</p>
                        <p class="text-2xl font-bold text-gray-900">R$ 12.000</p>
                    </div>
                    <div class="text-orange-500 text-3xl">üèÜ</div>
                </div>
            </div>
        </div>

        <!-- Gr√°fico de Proje√ß√µes -->
        <div class="card p-6 mb-8">
            <h2 class="text-xl font-bold text-gray-900 mb-4">üìä Proje√ß√£o de Receitas vs Despesas</h2>
            <canvas id="projectionsChart" width="400" height="200"></canvas>
        </div>

        <!-- Metas de Fechamento -->
        <div class="card p-6 mb-8">
            <h3 class="text-lg font-bold text-gray-900 mb-4">üéØ Metas de Fechamento - Pr√≥ximos 6 Meses</h3>
            <div id="monthlyTargets" class="space-y-4">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
        </div>

        <!-- Insights -->
        <div class="card p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">üí° Insights e Recomenda√ß√µes</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">üîç Padr√µes Identificados:</h4>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li>‚Ä¢ <strong>Pico hist√≥rico:</strong> Set/24 - R$ 12.000 (analise o que funcionou!)</li>
                        <li>‚Ä¢ <strong>2024 vs 2025:</strong> Queda significativa na performance</li>
                        <li>‚Ä¢ <strong>Tend√™ncia:</strong> 2025 em decl√≠nio desde maio</li>
                        <li>‚Ä¢ <strong>Oportunidade:</strong> Replicar estrat√©gias de set/24</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">üöÄ A√ß√µes Urgentes:</h4>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li>‚Ä¢ <strong>Investigar set/24:</strong> Que campanha gerou o pico?</li>
                        <li>‚Ä¢ <strong>Revisar custos:</strong> Margem diminuiu em 2025</li>
                        <li>‚Ä¢ <strong>Meta outubro:</strong> Superar R$ 8.000 atual</li>
                        <li>‚Ä¢ <strong>Planejamento:</strong> Usar este dashboard mensalmente</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-white opacity-75">
            <p>Dashboard criado para otimizar sua gest√£o financeira üöÄ</p>
        </div>
    </div>

    <script>
        // Dados hist√≥ricos reais
        const historicalData = [
            { month: 'Jun/24', revenue: 9000, expenses: 7000 },
            { month: 'Jul/24', revenue: 8500, expenses: 6800 },
            { month: 'Ago/24', revenue: 8200, expenses: 6500 },
            { month: 'Set/24', revenue: 12000, expenses: 8500 }, // Pico
            { month: 'Out/24', revenue: 11500, expenses: 8200 },
            { month: 'Nov/24', revenue: 11200, expenses: 8800 },
            { month: 'Dez/24', revenue: 11800, expenses: 9200 },
            { month: 'Jan/25', revenue: 7800, expenses: 6200 },
            { month: 'Fev/25', revenue: 8200, expenses: 6500 },
            { month: 'Mar/25', revenue: 9500, expenses: 7200 },
            { month: 'Abr/25', revenue: 8800, expenses: 7000 },
            { month: 'Mai/25', revenue: 7500, expenses: 6200 },
            { month: 'Jun/25', revenue: 8500, expenses: 6800 },
            { month: 'Jul/25', revenue: 7800, expenses: 6400 },
            { month: 'Ago/25', revenue: 7200, expenses: 6000 }
        ];

        // Elementos DOM
        const growthSlider = document.getElementById('growthSlider');
        const growthValue = document.getElementById('growthValue');
        const monthsSlider = document.getElementById('monthsSlider');
        const monthsValue = document.getElementById('monthsValue');
        const scenarioSelect = document.getElementById('scenarioSelect');
        const nextMonthTarget = document.getElementById('nextMonthTarget');
        const monthlyTargets = document.getElementById('monthlyTargets');

        // Chart.js instance
        let chart;

        // Fatores sazonais
        const seasonalFactors = {
            'Out': 1.05, 'Nov': 0.90, 'Dez': 0.75, 'Jan': 0.85, 'Fev': 0.90, 'Mar': 1.05,
            'Abr': 1.00, 'Mai': 1.10, 'Jun': 1.05, 'Jul': 1.15, 'Ago': 1.10, 'Set': 0.95
        };

        // Calcular proje√ß√µes
        function calculateProjections() {
            const growth = parseInt(growthSlider.value);
            const months = parseInt(monthsSlider.value);
            const scenario = parseFloat(scenarioSelect.value);
            
            const recentAvg = 7800; // M√©dia dos √∫ltimos 3 meses
            const monthlyGrowthRate = (growth / 100) / 12;
            
            const projections = [];
            const monthNames = ['Out', 'Nov', 'Dez', 'Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set'];
            
            for (let i = 0; i < months; i++) {
                const monthName = monthNames[i % 12];
                const seasonalFactor = seasonalFactors[monthName] || 1;
                
                const projectedRevenue = Math.round(
                    recentAvg * 
                    (1 + monthlyGrowthRate * (i + 1)) * 
                    seasonalFactor * 
                    scenario
                );
                
                const projectedExpenses = Math.round(projectedRevenue * 0.70);
                
                projections.push({
                    month: `${monthName}/25`,
                    revenue: projectedRevenue,
                    expenses: projectedExpenses,
                    profit: projectedRevenue - projectedExpenses
                });
            }
            
            return projections;
        }

        // Atualizar gr√°fico
        function updateChart() {
            const projections = calculateProjections();
            
            if (chart) {
                chart.destroy();
            }
            
            const ctx = document.getElementById('projectionsChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: projections.map(p => p.month),
                    datasets: [{
                        label: 'Receita Projetada',
                        data: projections.map(p => p.revenue),
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 3,
                        fill: true
                    }, {
                        label: 'Despesas Projetadas',
                        data: projections.map(p => p.expenses),
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2,
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + (value/1000).toFixed(0) + 'k';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': R$ ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Atualizar metas mensais
        function updateMonthlyTargets() {
            const projections = calculateProjections().slice(0, 6);
            
            monthlyTargets.innerHTML = projections.map((proj, index) => {
                const contractsNeeded = Math.ceil(proj.revenue / 1500);
                return `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-semibold text-gray-900">${proj.month}</p>
                            <p class="text-sm text-gray-600">${contractsNeeded} contratos necess√°rios</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-blue-600">R$ ${proj.revenue.toLocaleString()}</p>
                            <p class="text-sm text-green-600">+R$ ${proj.profit.toLocaleString()} lucro</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Atualizar pr√≥ximo m√™s
        function updateNextMonth() {
            const projections = calculateProjections();
            nextMonthTarget.textContent = `R$ ${projections[0].revenue.toLocaleString()}`;
        }

        // Event listeners
        growthSlider.addEventListener('input', function() {
            growthValue.textContent = this.value + '%';
            updateChart();
            updateMonthlyTargets();
            updateNextMonth();
        });

        monthsSlider.addEventListener('input', function() {
            monthsValue.textContent = this.value + ' meses';
            updateChart();
            updateMonthlyTargets();
        });

        scenarioSelect.addEventListener('change', function() {
            updateChart();
            updateMonthlyTargets();
            updateNextMonth();
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            updateChart();
            updateMonthlyTargets();
            updateNextMonth();
        });
    </script>
</body>
</html>
